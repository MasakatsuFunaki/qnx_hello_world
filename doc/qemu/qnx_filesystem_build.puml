@startuml qnx_filesystem_build
!theme plain
skinparam defaultFontName Monospaced

title **QNX QEMU — Image Build & Boot**

rectangle "Cross-compiled\nbinaries" as bins
rectangle "data_files.custom\n(snippet)" as snippet

rectangle "QNX SDP 8.0" as sdp {
    rectangle "mkqnximage" as mkqnx
}

rectangle "mkqnximage output" as output {
    rectangle "ifs.bin\n(micro-kernel + drivers)" as ifs
    rectangle "disk-qemu.vmdk\n(root filesystem)" as disk
}

rectangle "QEMU" as qemu {
    rectangle "x86_64: i440FX, IDE, PCI virtio" as x86
    rectangle "aarch64: virt-4.2, MMIO virtio" as arm
    rectangle "KVM (same-arch) or TCG (cross)" as accel
}

rectangle "QNX Neutrino guest\n/data/home/root/*\nSSH :2222 → :22" as guest

' ── Flow ─────────────────────────────────────────────────
bins -right-> snippet : "file mapping"
snippet -down-> mkqnx : "[uid=0 gid=0 perms=0755]\nhome/root/bin=<path>"
mkqnx -down-> ifs : "--type=qemu --build"
mkqnx -down-> disk
ifs -down-> qemu : "-kernel"
disk -down-> qemu : "-drive"
qemu -down-> guest : "boots"

@enduml
